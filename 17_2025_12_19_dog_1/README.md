# ğŸ• Automatic Canine Emotion Recognition (Implementation Demo)

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã€2025å¹´ã®è«–æ–‡ **"Automatic canine emotion recognition through multimodal approach"** ã§ææ¡ˆã•ã‚ŒãŸã€çŠ¬ã®æ„Ÿæƒ…èªè­˜ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’å†ç¾ãƒ»å®Ÿè£…ã—ãŸãƒ‡ãƒ¢ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚

**æ˜ åƒï¼ˆVisualï¼‰ã€æ…£æ€§ï¼ˆInertialï¼‰ã€ç”Ÿç†ï¼ˆPhysiologicalï¼‰** ã¨ã„ã†ç•°ãªã‚‹ç¨®é¡ã®ãƒ‡ãƒ¼ã‚¿ã‚’çµ±åˆã—ã€ç‰¹å¾´é‡é¸æŠã‚’çµŒã¦æ„Ÿæƒ…ã‚’åˆ†é¡ã™ã‚‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ Python ã§è¨˜è¿°ã—ã¦ã„ã¾ã™ã€‚

> **Note:**
> æœ¬ã‚³ãƒ¼ãƒ‰ã¯è«–æ–‡ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’è§£èª¬ãƒ»å†ç¾ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã‚ã‚Šã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§ãƒ€ãƒŸãƒ¼ç”Ÿæˆã—ã¦ã„ã¾ã™ã€‚å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§å‹•ä½œã•ã›ã‚‹å ´åˆã¯ã€ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿éƒ¨åˆ†ã‚’å·®ã—æ›¿ãˆã¦ãã ã•ã„ã€‚

## ğŸš€ ç‰¹å¾´ (Key Features)

è«–æ–‡ã§ææ¡ˆã•ã‚ŒãŸä»¥ä¸‹ã® **ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³** ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

1. **ãƒ‡ãƒ¼ã‚¿åŒæœŸ (Synchronization)**
* ç•°ãªã‚‹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆï¼ˆæ˜ åƒ 30fps, æ…£æ€§ 252Hz, ç”Ÿç† 1Hzï¼‰ã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿ã‚’ã€ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ™ãƒ¼ã‚¹ã§çµåˆãƒ»ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚


2. **ç‰¹å¾´é‡é¸æŠ (Feature Selection)**
* Random Forest ã‚’ç”¨ã„ã¦ã€320æ¬¡å…ƒã®ç‰¹å¾´é‡ã‹ã‚‰ã€Œæ„Ÿæƒ…åˆ¤åˆ¥ã«å¯„ä¸ã™ã‚‹é‡è¦åº¦ãŒé«˜ã„ç‰¹å¾´é‡ã€ã®ã¿ã‚’è‡ªå‹•é¸æŠœã—ã¾ã™ã€‚


3. **é«˜ç²¾åº¦åˆ†é¡ (Classification)**
* è«–æ–‡å†…ã§æœ€ã‚‚é«˜ã„ç²¾åº¦ (F1=0.96) ã‚’è¨˜éŒ²ã—ãŸ **ExtraTrees Classifier** ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚



## ğŸ“¦ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Python 3.8ä»¥ä¸Šæ¨å¥¨ã€‚å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```bash
pip install pandas numpy scikit-learn

```

## ğŸ’» ä½¿ã„æ–¹

ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã€ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
python main.py

```

### å®Ÿè¡Œçµæœã‚¤ãƒ¡ãƒ¼ã‚¸

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å‡¦ç†ï¼ˆåŒæœŸâ†’é¸æŠâ†’å­¦ç¿’ï¼‰ã‚’çµŒã¦ã€äº¤å·®æ¤œè¨¼(Cross Validation)ã®çµæœãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

```text
ğŸ”„ Synchronizing multimodal data...
âœ… Data merged. Shape: (300, 240)

ğŸ“‰ Selecting important features...
âœ… Features reduced: 240 -> 85

ğŸš€ Starting training with ExtraTrees...
------------------------------
ğŸ† Average F1-Score: 0.9650 (+/- 0.0400)
------------------------------

```

## ğŸ“‚ ã‚³ãƒ¼ãƒ‰è§£èª¬

ä¸»è¦ãªã‚¯ãƒ©ã‚¹ `CanineEmotionClassifier` ã®ãƒ¡ã‚½ãƒƒãƒ‰æ§‹æˆã§ã™ã€‚

| ãƒ¡ã‚½ãƒƒãƒ‰             | èª¬æ˜                                                                                               |
| -------------------- | -------------------------------------------------------------------------------------------------- |
| `synchronize_data`   | `resample` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã€æœ€ã‚‚ç²’åº¦ã®ç²—ã„ãƒ‡ãƒ¼ã‚¿ï¼ˆ1Hzï¼‰ã«åˆã‚ã›ã¦ä»–ã®ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’çµ±åˆã—ã¾ã™ã€‚ |
| `select_features`    | `SelectFromModel` (Random Forestãƒ™ãƒ¼ã‚¹) ã‚’ä½¿ç”¨ã—ã€å¹³å‡ä»¥ä¸Šã®é‡è¦åº¦ã‚’æŒã¤ç‰¹å¾´é‡ã®ã¿ã‚’æŠ½å‡ºã—ã¾ã™ã€‚   |
| `train_and_evaluate` | `ExtraTreesClassifier` ã‚’ä½¿ç”¨ã—ã€Stratified 5-fold Cross Validation ã§ãƒ¢ãƒ‡ãƒ«ã‚’è©•ä¾¡ã—ã¾ã™ã€‚         |

## ğŸ“Š ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¤ã„ã¦

æœ¬è«–æ–‡ã§ä½¿ç”¨ã•ã‚ŒãŸå®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆDeepLabCutã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆã‚„PATITAãƒ‡ãƒã‚¤ã‚¹ã®ãƒ­ã‚°ï¼‰ã¯ã€è‘—è€…ã®GitHubã«ã¦å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚æœ¬ç•ªç’°å¢ƒã§è©¦ã—ãŸã„æ–¹ã¯ä»¥ä¸‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

* **Dataset Link**: [Automatic-Canine-Emotion-Recognition-Through-Multimodal-Approach-DATASET](https://www.google.com/search?q=https://github.com/eliafg/Automatic-Canine-Emotion-Recognition-Through-Multimodal-Approach-DATASET-)